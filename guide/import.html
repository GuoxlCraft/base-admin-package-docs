<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>安装依赖 | 起源公共依赖库</title>
    <meta name="generator" content="VuePress 1.8.2">
    
    <meta name="description" content="基于vue2.7的npm私库">
    
    <link rel="preload" href="/base-admin-package-docs/assets/css/0.styles.248a7388.css" as="style"><link rel="preload" href="/base-admin-package-docs/assets/js/app.7f2402a0.js" as="script"><link rel="preload" href="/base-admin-package-docs/assets/js/2.dff8b5e7.js" as="script"><link rel="preload" href="/base-admin-package-docs/assets/js/34.b5e9b52a.js" as="script"><link rel="prefetch" href="/base-admin-package-docs/assets/js/10.48dd2971.js"><link rel="prefetch" href="/base-admin-package-docs/assets/js/11.4998cefc.js"><link rel="prefetch" href="/base-admin-package-docs/assets/js/12.138b100d.js"><link rel="prefetch" href="/base-admin-package-docs/assets/js/13.96c688ca.js"><link rel="prefetch" href="/base-admin-package-docs/assets/js/14.4be731c1.js"><link rel="prefetch" href="/base-admin-package-docs/assets/js/15.0e93220f.js"><link rel="prefetch" href="/base-admin-package-docs/assets/js/16.2d523b5f.js"><link rel="prefetch" href="/base-admin-package-docs/assets/js/17.a9e503f6.js"><link rel="prefetch" href="/base-admin-package-docs/assets/js/18.6ae19916.js"><link rel="prefetch" href="/base-admin-package-docs/assets/js/19.4686ee08.js"><link rel="prefetch" href="/base-admin-package-docs/assets/js/20.7fa68b9a.js"><link rel="prefetch" href="/base-admin-package-docs/assets/js/21.07d32693.js"><link rel="prefetch" href="/base-admin-package-docs/assets/js/22.172b18c1.js"><link rel="prefetch" href="/base-admin-package-docs/assets/js/23.e9db04bf.js"><link rel="prefetch" href="/base-admin-package-docs/assets/js/24.47bf070f.js"><link rel="prefetch" href="/base-admin-package-docs/assets/js/25.a840fc35.js"><link rel="prefetch" href="/base-admin-package-docs/assets/js/26.513477b3.js"><link rel="prefetch" href="/base-admin-package-docs/assets/js/27.dc052b39.js"><link rel="prefetch" href="/base-admin-package-docs/assets/js/28.0311efc0.js"><link rel="prefetch" href="/base-admin-package-docs/assets/js/29.8a74a445.js"><link rel="prefetch" href="/base-admin-package-docs/assets/js/3.9c9f4250.js"><link rel="prefetch" href="/base-admin-package-docs/assets/js/30.17e07891.js"><link rel="prefetch" href="/base-admin-package-docs/assets/js/31.046ead33.js"><link rel="prefetch" href="/base-admin-package-docs/assets/js/32.e1e842eb.js"><link rel="prefetch" href="/base-admin-package-docs/assets/js/33.7a1ac1b4.js"><link rel="prefetch" href="/base-admin-package-docs/assets/js/35.6760b669.js"><link rel="prefetch" href="/base-admin-package-docs/assets/js/4.107fa8c4.js"><link rel="prefetch" href="/base-admin-package-docs/assets/js/5.6f035680.js"><link rel="prefetch" href="/base-admin-package-docs/assets/js/6.256830b0.js"><link rel="prefetch" href="/base-admin-package-docs/assets/js/7.b460697d.js"><link rel="prefetch" href="/base-admin-package-docs/assets/js/8.d219bb3a.js"><link rel="prefetch" href="/base-admin-package-docs/assets/js/9.e161732f.js">
    <link rel="stylesheet" href="/base-admin-package-docs/assets/css/0.styles.248a7388.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/base-admin-package-docs/" class="home-link router-link-active"><!----> <span class="site-name">起源公共依赖库</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/base-admin-package-docs/" class="nav-link">
  首页
</a></div><div class="nav-item"><a href="/base-admin-package-docs/guide/" class="nav-link router-link-active">
  指南
</a></div><div class="nav-item"><a href="/base-admin-package-docs/components/" class="nav-link">
  功能组件
</a></div><div class="nav-item"><a href="/base-admin-package-docs/changLog/changLog.html" class="nav-link">
  更新日志
</a></div><div class="nav-item"><a href="http://8.133.179.48:4000/dist" target="_blank" rel="noopener noreferrer" class="nav-link external">
  预览
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div><div class="nav-item"><a href="http://192.168.169.57:9000/scm/git/hzt-webdocs.git" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/base-admin-package-docs/" class="nav-link">
  首页
</a></div><div class="nav-item"><a href="/base-admin-package-docs/guide/" class="nav-link router-link-active">
  指南
</a></div><div class="nav-item"><a href="/base-admin-package-docs/components/" class="nav-link">
  功能组件
</a></div><div class="nav-item"><a href="/base-admin-package-docs/changLog/changLog.html" class="nav-link">
  更新日志
</a></div><div class="nav-item"><a href="http://8.133.179.48:4000/dist" target="_blank" rel="noopener noreferrer" class="nav-link external">
  预览
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div><div class="nav-item"><a href="http://192.168.169.57:9000/scm/git/hzt-webdocs.git" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>基础</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/base-admin-package-docs/guide/" aria-current="page" class="sidebar-link">介绍</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>如何使用</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/base-admin-package-docs/guide/import.html" aria-current="page" class="active sidebar-link">安装依赖</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/base-admin-package-docs/guide/import.html#yalc" class="sidebar-link">yalc</a></li><li class="sidebar-sub-header"><a href="/base-admin-package-docs/guide/import.html#yarn-link-cnpm-link" class="sidebar-link">yarn link/cnpm link</a></li></ul></li><li><a href="/base-admin-package-docs/guide/inject.html" class="sidebar-link">组件引入</a></li><li><a href="/base-admin-package-docs/guide/component.html" class="sidebar-link">组件引入</a></li><li><a href="/base-admin-package-docs/guide/hooks.html" class="sidebar-link">项目配置</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>如何扩展</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/base-admin-package-docs/guide/develop.html" class="sidebar-link">项目配置</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="安装依赖"><a href="#安装依赖" class="header-anchor">#</a> 安装依赖</h1> <p>使用本依赖库，需要先进入依赖库根目录，运行<code>npm run build</code>打包。打出来的umd包能够通过npm发布。您可以选择发布npm的公共包，但则需要在<a href="https://www.npmjs.com/" target="_blank" rel="noopener noreferrer">npm<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>上注册账号等，详细的发包流程可以阅读<a href="https://www.jianshu.com/p/9325240352a4" target="_blank" rel="noopener noreferrer">发布依赖到npm公库流程<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>。</p> <p>由于公共库发包过程复杂，这里建议使用私库方案来使用本依赖库。推荐的npm私库方案有 yalc 和 yarn/cnpm link。</p> <div class="custom-block tip"><p class="custom-block-title">提示</p> <p>使用vite搭建的业务项目，需要注意一下。vite对第三方依赖有预编译缓存的功能，为了加快esbuild的效率。因此，在依赖库拓展开发后无法更新到被引入的业务项目中去（vite优先加载node_modules中 .vite/deps 的缓存）。这使得要更新依赖库需要手动删除node_modules，重新安装。在后续，会想办法解决（困扰）。
另外，由于npm link对依赖库中的循环引用的问题处理的不好，本依赖包不推荐使用npm link。可以尝试用cnpm link或者yarn link。</p></div> <h2 id="yalc"><a href="#yalc" class="header-anchor">#</a> yalc</h2> <p>yalc 可以在本地将 npm 包模拟发布，将发布后的资源存放在一个全局存储中。然后可以通过 yalc 将包添加进需要引用的项目中。</p> <p>这时候 package.json 的依赖表中会多出一个 file:.yalc/... 的依赖包，这就是 yalc 创建的特殊引用。同时也会在项目根目录创建一个 yalc.lock 确保引用资源的一致性。</p> <p>首先您需要全局安装yalc</p> <div class="language-sh extra-class"><pre class="language-sh"><code><span class="token function">npm</span> <span class="token function">install</span> yalc -g
</code></pre></div><p>在依赖库根目录下执行</p> <div class="language-sh extra-class"><pre class="language-sh"><code><span class="token function">npm</span> run build <span class="token operator">&amp;&amp;</span> yalc publish
</code></pre></div><p>在项目目录下执行</p> <div class="language-sh extra-class"><pre class="language-sh"><code>yalc <span class="token function">add</span> base-admin
</code></pre></div><p>这里会将本次构建的base-admin依赖库安装到项目中。在业务项目的根目录生成一份.yalc的目录，存放依赖包。在package.json中通过file:.yalc/...指向该包形成依赖关系。</p> <div class="language-sh extra-class"><pre class="language-sh"><code>  <span class="token string">&quot;dependencies&quot;</span><span class="token builtin class-name">:</span> <span class="token punctuation">{</span>
    <span class="token string">&quot;@babel/runtime&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;^7.16.0&quot;</span>,
    <span class="token string">&quot;axios&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;^0.24.0&quot;</span>,
    <span class="token string">&quot;base-admin&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;file:.yalc/base-admin&quot;</span>, //yalc 生产的base-admin的依赖关系
    <span class="token string">&quot;core-js&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;^3.19.0&quot;</span>,
    <span class="token punctuation">..</span>.
  <span class="token punctuation">}</span>
</code></pre></div><p>这里补充一下yalc在依赖库更新时的用法。</p> <p>当对本依赖库进行拓展开发时，需要变更依赖库中package.json的版本号。</p> <div class="language-sh extra-class"><pre class="language-sh"><code>  <span class="token string">&quot;name&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;base-admin&quot;</span>,
  <span class="token string">&quot;version&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;1.1.0&quot;</span>, // 在更新了依赖库之后，需要更新version的值。yalc才会进行响应
  <span class="token string">&quot;description&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;起源项目的基础依赖包&quot;</span>,
  <span class="token string">&quot;main&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;dist/main.js&quot;</span>,
</code></pre></div><p>然后在依赖库根目录下执行</p> <div class="language-sh extra-class"><pre class="language-sh"><code><span class="token function">npm</span> run build <span class="token operator">&amp;&amp;</span> yalc push
</code></pre></div><p>新版本的依赖库，会自动同步更新到所有引入该依赖库的业务项目中。</p> <h2 id="yarn-link-cnpm-link"><a href="#yarn-link-cnpm-link" class="header-anchor">#</a> yarn link/cnpm link</h2> <p>这两种方式的发包流程大致相同，这里就以 yarn 举例。</p> <p>同样首先您需要全局安装yarn或者cnpm</p> <p>在依赖库根目录下执行</p> <div class="language-sh extra-class"><pre class="language-sh"><code><span class="token function">npm</span> run build <span class="token operator">&amp;&amp;</span> <span class="token function">yarn</span> <span class="token function">link</span>
</code></pre></div><p>此时yarn会在全局存入一份该依赖包。</p> <p>在项目目录下执行</p> <div class="language-sh extra-class"><pre class="language-sh"><code><span class="token function">yarn</span> <span class="token function">link</span> base-admin
</code></pre></div><p>这里会将本次构建的base-admin依赖库安装到项目中。
在业务项目的node_modules中添加base-admin的依赖包。</p> <p>当对本依赖库进行拓展开发时，同需要变更依赖库中package.json的版本号。</p> <p>然后在依赖库根目录下执行</p> <div class="language-sh extra-class"><pre class="language-sh"><code><span class="token function">npm</span> run build
</code></pre></div><p>新打出来的包，会直接更新到所有引入该依赖库的业务项目中。</p></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/base-admin-package-docs/guide/" class="prev router-link-active">
        介绍
      </a></span> <span class="next"><a href="/base-admin-package-docs/guide/inject.html">
        组件引入
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/base-admin-package-docs/assets/js/app.7f2402a0.js" defer></script><script src="/base-admin-package-docs/assets/js/2.dff8b5e7.js" defer></script><script src="/base-admin-package-docs/assets/js/34.b5e9b52a.js" defer></script>
  </body>
</html>
